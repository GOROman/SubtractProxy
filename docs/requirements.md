# SubtractProxy プロジェクト要件定義書

## 1. プロジェクト概要

### 1.1 プロジェクトの目的

- シンプルで軽量な Web Proxy Server
- Subtract つまり情報の引き算を行う
- Chrome などから接続可能
- robots.txt などを無視するオプション 
- ollama や OpenRouter などのLLMにフィルタリングさせる
- X などのクソリプなどを回避する

### 1.2 対象ユーザー
- 個人

## 2. 機能要件

### 2.1 基本機能
- HTTPプロキシサーバー機能
- HTTPSサポート
- リクエスト/レスポンスの仲介処理
- コンテンツの最適化処理
- LLM対応

### 2.2 最適化機能
- 不要なコンテンツの除去
- キャッシュ制御の最適化

### 2.3 管理機能
- プロキシ設定の管理
- 最適化ルールの設定
- ログ管理

## 3. 非機能要件

### 3.1 性能要件
- レイテンシーの最小化（追加遅延 50ms以内）
- 高スループット（1000req/sec以上）
- メモリ使用量の最適化

### 3.2 セキュリティ要件
- HTTPS通信のサポート
- セキュアな証明書管理
- アクセス制御
- データの暗号化

### 3.3 運用要件
- 簡単な設定と導入

## 4. 技術スタック

### 4.1 バックエンド
- TypeScript/Node.js
- Express.js または類似のWebフレームワーク
- HTTPプロキシライブラリ

### 4.2 フロントエンド（管理画面）
- React
- Tailwind CSS
- Shadcn UI

### 4.3 データストア
- 設定データ: SQLite/AstroDB
- キャッシュ: Redis（オプション）

## 5. 開発フェーズ

### Phase 1: 基本機能実装
- プロキシサーバーの基本機能実装
- HTTPS対応
- 基本的な最適化機能の実装

### Phase 2: 最適化機能拡張
- 高度な画像最適化
- コンテンツ最適化機能の拡張
- キャッシュ制御の実装

### Phase 3: 管理機能実装
- 管理画面の開発
- モニタリング機能の実装
- 設定管理機能の実装

### Phase 4: パフォーマンスチューニング
- 性能最適化
- セキュリティ強化
- 運用機能の実装

## 6. 成功基準
- ページロード時間の30%以上の削減
- データ転送量の50%以上の削減
- 99.9%以上の可用性
- セキュリティインシデント0件

## 7. 制約条件
- オープンソースライセンスでの公開
- クロスプラットフォーム対応
- 最小限の依存関係
- メモリ使用量の最適化

## 8. 今後の拡張性
- プラグインシステムの導入
- カスタム最適化ルールの追加
- 分散システム対応
- APIの提供
